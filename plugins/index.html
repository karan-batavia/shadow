<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Using Shadow to Package Gradle Plugins</title>
    <meta name="generator" content="VuePress 1.9.10">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/shadow/assets/css/0.styles.1a56c3fc.css" as="style"><link rel="preload" href="/shadow/assets/js/app.4e4a321c.js" as="script"><link rel="preload" href="/shadow/assets/js/2.3dc1b8de.js" as="script"><link rel="preload" href="/shadow/assets/js/1.7f771cfb.js" as="script"><link rel="preload" href="/shadow/assets/js/38.bd1382b8.js" as="script"><link rel="prefetch" href="/shadow/assets/js/10.23a1f579.js"><link rel="prefetch" href="/shadow/assets/js/11.c389195a.js"><link rel="prefetch" href="/shadow/assets/js/12.1d996921.js"><link rel="prefetch" href="/shadow/assets/js/13.11b1ca6a.js"><link rel="prefetch" href="/shadow/assets/js/14.37ef2a72.js"><link rel="prefetch" href="/shadow/assets/js/15.5542c093.js"><link rel="prefetch" href="/shadow/assets/js/16.d48fd1ce.js"><link rel="prefetch" href="/shadow/assets/js/17.bd8d538c.js"><link rel="prefetch" href="/shadow/assets/js/18.6d3b94c1.js"><link rel="prefetch" href="/shadow/assets/js/19.eb35cfee.js"><link rel="prefetch" href="/shadow/assets/js/20.c11ec329.js"><link rel="prefetch" href="/shadow/assets/js/21.db1b5d88.js"><link rel="prefetch" href="/shadow/assets/js/22.2fc874b5.js"><link rel="prefetch" href="/shadow/assets/js/23.840c7753.js"><link rel="prefetch" href="/shadow/assets/js/24.42f7d0e0.js"><link rel="prefetch" href="/shadow/assets/js/25.4925f20a.js"><link rel="prefetch" href="/shadow/assets/js/26.974f8a3e.js"><link rel="prefetch" href="/shadow/assets/js/27.afb9c0e8.js"><link rel="prefetch" href="/shadow/assets/js/28.ca76898b.js"><link rel="prefetch" href="/shadow/assets/js/29.608ef56f.js"><link rel="prefetch" href="/shadow/assets/js/3.5322f14a.js"><link rel="prefetch" href="/shadow/assets/js/30.83fa90c6.js"><link rel="prefetch" href="/shadow/assets/js/31.5e21405d.js"><link rel="prefetch" href="/shadow/assets/js/32.0ec6612d.js"><link rel="prefetch" href="/shadow/assets/js/33.dfb14846.js"><link rel="prefetch" href="/shadow/assets/js/34.64dc70c0.js"><link rel="prefetch" href="/shadow/assets/js/35.c2a2c99c.js"><link rel="prefetch" href="/shadow/assets/js/36.ebf210ff.js"><link rel="prefetch" href="/shadow/assets/js/37.1ad78ad3.js"><link rel="prefetch" href="/shadow/assets/js/39.9ac57283.js"><link rel="prefetch" href="/shadow/assets/js/4.eed64932.js"><link rel="prefetch" href="/shadow/assets/js/5.f0541060.js"><link rel="prefetch" href="/shadow/assets/js/6.dfb06aa0.js"><link rel="prefetch" href="/shadow/assets/js/7.7551a9fb.js"><link rel="prefetch" href="/shadow/assets/js/vendors~docsearch.5e19b665.js">
    <link rel="stylesheet" href="/shadow/assets/css/0.styles.1a56c3fc.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/shadow/" class="home-link router-link-active"><img src="/shadow/logo+type.svg" alt="" class="logo"> <!----></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/shadow/introduction/" class="nav-link">
  User Guide
</a></div> <a href="https://github.com/GradleUp/shadow" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/shadow/introduction/" class="nav-link">
  User Guide
</a></div> <a href="https://github.com/GradleUp/shadow" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/shadow/" aria-current="page" class="sidebar-link">Home</a></li><li><a href="/shadow/introduction/" class="sidebar-link">Introduction</a></li><li><a href="/shadow/getting-started/" class="sidebar-link">Getting Started</a></li><li><a href="/shadow/configuration/" class="sidebar-link">Configuring Shadow</a></li><li><a href="/shadow/configuration/filtering/" class="sidebar-link">Filtering Shadow Jar Contents</a></li><li><a href="/shadow/configuration/dependencies/" class="sidebar-link">Configuring Shadowed Dependencies</a></li><li><a href="/shadow/configuration/merging/" class="sidebar-link">Controlling JAR Content Merging</a></li><li><a href="/shadow/configuration/relocation/" class="sidebar-link">Relocating Packages</a></li><li><a href="/shadow/configuration/minimizing/" class="sidebar-link">Minimizing</a></li><li><a href="/shadow/configuration/reproducible-builds/" class="sidebar-link">Reproducible Builds</a></li><li><a href="/shadow/custom-tasks/" class="sidebar-link">Creating a Custom ShadowJar Task</a></li><li><a href="/shadow/application-plugin/" class="sidebar-link">Integrating with Application Plugin</a></li><li><a href="/shadow/publishing/" class="sidebar-link">Publishing Shadow JARs</a></li><li><a href="/shadow/multi-project/" class="sidebar-link">Using Shadow in Multi-Project Builds</a></li><li><a href="/shadow/plugins/" aria-current="page" class="active sidebar-link">Using Shadow to Package Gradle Plugins</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/shadow/plugins/#publishing-shadowed-gradle-plugins" class="sidebar-link">Publishing shadowed Gradle plugins</a></li><li class="sidebar-sub-header"><a href="/shadow/plugins/#automatic-package-relocation-with-shadow-prior-to-v8-1-0" class="sidebar-link">Automatic package relocation with Shadow prior to v8.1.0</a></li></ul></li><li><a href="/shadow/changes/" class="sidebar-link">Change Log</a></li><li><a href="/shadow/about/" class="sidebar-link">About This Project</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="using-shadow-to-package-gradle-plugins"><a href="#using-shadow-to-package-gradle-plugins" class="header-anchor">#</a> Using Shadow to Package Gradle Plugins</h1> <p>In some scenarios, writing a Gradle plugin can be problematic because your plugin may depend on a version that
conflicts with the same dependency provided by the Gradle runtime. If this is the case, then you can utilize Shadow
to relocate your dependencies to a different package name to avoid the collision.</p> <p>Configuring the relocation has always been possible, but the build author is required to know all the package names
beforehand. As of Shadow v8.1.0, automatic package relocation can be enabled by setting the <code>enabledRelocation</code>
and <code>relocationPrefix</code> settings on any <code>ShadowJar</code> task.</p> <p>A simple Gradle plugin can use this feature by applying the <code>shadow</code> plugin and configuring the <code>shadowJar</code> task for relocation.</p> <div class="language-groovy extra-class"><pre class="language-groovy"><code>apply plugin<span class="token punctuation">:</span> <span class="token string">'java'</span>
apply plugin<span class="token punctuation">:</span> <span class="token string">'com.gradleup.shadow'</span>

dependencies <span class="token punctuation">{</span>
  shadow <span class="token function">localGroovy</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  shadow <span class="token function">gradleApi</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  implementation <span class="token string">'org.jdom:jdom2:2.0.6'</span>
  implementation <span class="token string">'org.ow2.asm:asm:6.0'</span>
  implementation <span class="token string">'org.ow2.asm:asm-commons:6.0'</span>
  implementation <span class="token string">'commons-io:commons-io:2.4'</span>
  implementation <span class="token string">'org.apache.ant:ant:1.9.4'</span>
  implementation <span class="token string">'org.codehaus.plexus:plexus-utils:2.0.6'</span>
<span class="token punctuation">}</span>

tasks<span class="token punctuation">.</span><span class="token function">named</span><span class="token punctuation">(</span><span class="token string">'shadowJar'</span><span class="token punctuation">,</span> com<span class="token punctuation">.</span>github<span class="token punctuation">.</span>jengelman<span class="token punctuation">.</span>gradle<span class="token punctuation">.</span>plugins<span class="token punctuation">.</span>shadow<span class="token punctuation">.</span>tasks<span class="token punctuation">.</span>ShadowJar<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  enableRelocation <span class="token operator">=</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Note that the <code>localGroovy()</code> and <code>gradleApi()</code> dependencies are added to the <code>shadow</code> configuration instead of the
normal <code>compile</code> configuration. These 2 dependencies are provided by Gradle to compile your project but are ultimately
provided by the Gradle runtime when executing the plugin. Thus, it is <strong>not</strong> advisable to bundle these dependencies
with your plugin.</p> <h2 id="publishing-shadowed-gradle-plugins"><a href="#publishing-shadowed-gradle-plugins" class="header-anchor">#</a> Publishing shadowed Gradle plugins</h2> <p>The Gradle Publish Plugin introduced support for plugins packaged with Shadow in version 1.0.0.
Starting with this version, plugin projects that apply both Shadow and the Gradle Plugin Publish plugin will be
automatically configured to publish the output of the <code>shadowJar</code> tasks as the consumable artifact for the plugin.
See the <a href="https://docs.gradle.org/current/userguide/publishing_gradle_plugins.html#shadow_dependencies" target="_blank" rel="noopener noreferrer">Gradle Plugin Publish docs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> for details.</p> <h2 id="automatic-package-relocation-with-shadow-prior-to-v8-1-0"><a href="#automatic-package-relocation-with-shadow-prior-to-v8-1-0" class="header-anchor">#</a> Automatic package relocation with Shadow prior to v8.1.0</h2> <p>Prior to Shadow v8.1.0, Shadow handled this by introducing a new task type <code>ConfigureShadowRelocation</code>.
Tasks of this type are configured to target an instance of a <code>ShadowJar</code> task and run immediately before it.</p> <p>The <code>ConfigureShadowRelocation</code> task, scans the dependencies from the configurations specified on the associated
<code>ShadowJar</code> task and collects the package names contained within them. It then configures relocation for these
packages using the specified <code>prefix</code> on the associated <code>ShadowJar</code> task.</p> <p>While this is useful for developing Gradle plugins, nothing about the <code>ConfigureShadowRelocation</code> task is tied to
Gradle projects. It can be used for standard Java or Groovy projects.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/GradleUp/shadow/edit/main/src/docs/plugins/README.md" target="_blank" rel="noopener noreferrer">Help improve these docs!</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/shadow/multi-project/" class="prev">
        Using Shadow in Multi-Project Builds
      </a></span> <span class="next"><a href="/shadow/changes/">
        Change Log
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/shadow/assets/js/app.4e4a321c.js" defer></script><script src="/shadow/assets/js/2.3dc1b8de.js" defer></script><script src="/shadow/assets/js/1.7f771cfb.js" defer></script><script src="/shadow/assets/js/38.bd1382b8.js" defer></script>
  </body>
</html>
